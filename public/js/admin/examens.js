// Generated by CoffeeScript 1.7.1

/*
 * La liste des examens
 * clic sur une ligne -> affiche l'Ã©diteur d'examen
 */
var AdminExamens;

AdminExamens = (function() {
  var exPoolCount, examens, urlAdexa1;

  examens = null;

  exPoolCount = null;

  urlAdexa1 = null;

  function AdminExamens() {
    this.examens = _.map(window.jsp.examens);
    this.exPoolCount = window.jsp.exPoolCount;
    this.urlAdexa1 = window.jsp.urlAdexa1;
  }

  AdminExamens.prototype.go = function() {
    var dt;
    dt = this.renderTable();
    return dt.on("click", "tbody tr td", (function(_this) {
      return function(e) {
        var aPos, row, url;
        aPos = dt.fnGetPosition(e.target);
        row = dt.fnGetData(aPos[0]);
        url = gb.urlHelper(_this.urlAdexa1, {
          id: row.id
        });
        return window.open(url, "adexa1");
      };
    })(this));
  };

  AdminExamens.prototype.renderTable = function() {
    var aoColumns, dt;
    dt = $("div.examens table.dteditor");
    aoColumns = _.map(_.keys(this.examens[0]), function(key) {
      return {
        sTitle: key,
        mData: key
      };
    });
    aoColumns.push({
      sTitle: "pool count",
      mData: (function(_this) {
        return function(row, type, data) {
          return _this.exPoolCount[row.id];
        };
      })(this)
    });
    dt.dataTable({
      bPaginate: false,
      bFilter: false,
      bInfo: false,
      iDisplayLength: 5,
      aaData: this.examens,
      aoColumns: aoColumns
    });
    dt.addClass("table table-striped table-bordered");
    return dt;
  };

  return AdminExamens;

})();
