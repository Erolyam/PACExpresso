<?php if(!$GLOBALS["_min"]):?><script src="public/extlib/datatables/jquery.dataTables.js"></script><?php endif; ?>
<?php if(!$GLOBALS["_min"]):?><script src="public/extlib/datatables/DT_bootstrap.js"></script><?php endif; ?>
<?php if( $GLOBALS["_min"]):?><script src="public/compiled/layout_admin.js"></script><?php endif; ?>

<style>
div.bilan table tr td:nth-child(2):hover {
    cursor:pointer;
    text-decoration:underline;
}
</style>

<div class='container'>
<div class="bilan">
<?= $this->out ?>
</div>

<? $this->onready.= <<<HEREDOC
$("div.bilan table").dataTable({
    bPaginate:false, bFilter:false, bInfo:false, iDisplayLength:5,
});

$("div.bilan table").addClass("table table-striped table-bordered");


$("div.bilan table").on("click", "tr td:nth-child(1)", function(e){
    var id = $(e.target).text();
    var url = window.jsp.urlAlinea;
    url = url.replace("[:id]", id);
    url = url.replace("[:format]", "html");

    var elem=$(this);
    elem.unbind("click");

    $.ajax(url, {}).done(function(body){
      elem.popover({html:true, content:body, trigger:"manual", container:".bilan"}).popover("show");
    });

});

$("div.bilan table").on("click", "tr td:nth-child(2)", function(e){
    var id = $(e.target).prev().text();
    var url = window.jsp.urlAlinea;
    url = url.replace("[:id]", id);
    url = url.replace("[:format]", "html");

    var win1 = window.open("", "_blank");
    e.preventDefault();
    if (null === win1) { alert("Autorisez cette page Ã  ouvrir des popups."); }

    win1.location.href = url;
});
HEREDOC;
?>

</div>
